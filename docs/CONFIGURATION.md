# Configuration Guide

## Overview

The Property Manager uses multiple configuration files to control site behavior, appearance, and content. This guide covers all configuration options and their usage.

## Configuration Files

### 1. `sites.config.json` - Site Management

The master configuration file for all property sites.

#### Global Settings

```json
{
  "global": {
    "default_bedrooms": 3,
    "default_bathrooms": 2,
    "default_sqft": 2000,
    "strict_mode": true,
    "max_misc_docs": 5
  }
}
```

| Setting | Type | Description |
|---------|------|-------------|
| `default_bedrooms` | number | Default bedroom count for plans |
| `default_bathrooms` | number | Default bathroom count for plans |
| `default_sqft` | number | Default square footage |
| `strict_mode` | boolean | Enable strict file matching |
| `max_misc_docs` | number | Maximum miscellaneous documents to display |

#### Site Configuration

```json
{
  "sites": [
    {
      "slug": "lancaster-12",
      "name": "Lancaster 12",
      "aliases": ["LANCASTER", "LANCASTER 12"],
      "drive_folder_id": "FOLDER_ID",
      "lot_count": 12,
      "lot_details": {...},
      "lot_requirements": {...},
      "plan_details": {...},
      "document_overrides": {...}
    }
  ]
}
```

| Field | Type | Description |
|-------|------|-------------|
| `slug` | string | URL-friendly identifier |
| `name` | string | Display name |
| `aliases` | array | Alternative names for file matching |
| `drive_folder_id` | string | Google Drive folder ID |
| `lot_count` | number | Total number of lots |

### 2. `config/images.json` - Image Assets

Controls all image assets including photos, logos, and backgrounds.

#### Owner Configuration

```json
{
  "owner": {
    "photo": {
      "src": "/public/brand/owner/photo.jpg",
      "alt": "Owner Name",
      "caption": "Owner Name ‚Äî Title",
      "loading": "eager",
      "display": true
    }
  }
}
```

#### Logo Configuration

```json
{
  "logos": {
    "header": {
      "src": "/public/brand/logos/logo.png",
      "alt": "Company Name",
      "width": 280,
      "loading": "eager",
      "display": true
    },
    "footer": {
      "src": "/public/brand/logos/logo.png",
      "alt": "Company Name",
      "width": 180,
      "display": true
    }
  }
}
```

#### Background Configuration

```json
{
  "backgrounds": {
    "hero": {
      "image": "/public/backgrounds/hero-bg.jpg",
      "overlay": "linear-gradient(rgba(0,0,0,0.3), rgba(0,0,0,0.5))",
      "position": "center center",
      "size": "cover",
      "attachment": "fixed",
      "enabled": true
    }
  }
}
```

### 3. `sites/[site-name]/data.json` - Site Data

Generated by the smart mapper or manually created for each site.

#### Structure

```json
{
  "slug": "lancaster-12",
  "siteName": "Lancaster 12 Lots",
  "brand": {
    "title": "Lancaster 12 Lots",
    "tagline": "Premium Development Properties",
    "metaDescription": "12 premium lots in Lancaster, CA"
  },
  "contact": {
    "companyName": "Huntington Beach Capital Partners, Inc.",
    "ownerName": "Rick Reza",
    "phoneDisplay": "714-713-8618",
    "phoneE164": "+17147138618",
    "email": "rickreza@yahoo.com",
    "folderId": "DRIVE_FOLDER_ID"
  },
  "location": {
    "city": "Lancaster",
    "state": "CA",
    "address": "Lancaster, California"
  },
  "presentation": {
    "title": "Complete Presentation",
    "file": "DRIVE_FILE_ID"
  },
  "plans": [...],
  "lots": [...],
  "projectDocs": [...]
}
```

### 4. `package.json` - Build Configuration

Defines linting and formatting rules.

```json
{
  "scripts": {
    "lint": "eslint",
    "format": "prettier --write \"**/*.{js,json,md,html,css}\"",
    "python:lint": "poetry run ruff check scripts/",
    "python:format": "poetry run black scripts/"
  }
}
```

## Lot Configuration

### Lot Details

Define specific information for each lot:

```json
{
  "lot_details": {
    "2": {
      "apn": "3203-063-002",
      "address": "43741 Verella Ct",
      "status": "Owned",
      "size": "~0.25 acres",
      "has_title_report": true,
      "has_grading": false,
      "has_plan_assignment": false,
      "doc_refs": {
        "title_report": "DRIVE_FILE_ID",
        "platmap": "DRIVE_FILE_ID"
      }
    }
  }
}
```

#### Available Fields

| Field | Type | Description |
|-------|------|-------------|
| `apn` | string | Assessor's Parcel Number |
| `address` | string | Physical address |
| `status` | string | "Owned", "Available", "Pending", etc. |
| `size` | string | Lot size description |
| `has_title_report` | boolean | Title report availability |
| `has_grading` | boolean | Grading plan availability |
| `has_plan_assignment` | boolean | Plan assignment status |
| `doc_refs` | object | Direct document references |

### Lot Requirements

Control lot display and tracking:

```json
{
  "lot_requirements": {
    "show_missing": true,
    "hide_incomplete": false,
    "required_docs": ["title_report", "grading", "plan_assignment"],
    "show_status_in_size": false
  }
}
```

| Setting | Type | Description |
|---------|------|-------------|
| `show_missing` | boolean | Display missing documents |
| `hide_incomplete` | boolean | Hide incomplete lots |
| `required_docs` | array | Documents required for completion |
| `show_status_in_size` | boolean | Include status in size field |

## Plan Configuration

### Plan Details

Specify details for each floor plan:

```json
{
  "plan_details": {
    "1": {
      "bedrooms": 4,
      "bathrooms": 3,
      "sqft": 2168,
      "stories": 1,
      "garage_sf": 440,
      "description": "Single story ranch style"
    }
  }
}
```

| Field | Type | Description |
|-------|------|-------------|
| `bedrooms` | number | Number of bedrooms |
| `bathrooms` | number | Number of bathrooms |
| `sqft` | number | Square footage |
| `stories` | number | Number of stories |
| `garage_sf` | number | Garage square footage |
| `description` | string | Plan description |

## Document Configuration

### Document Overrides

Customize document display:

```json
{
  "document_overrides": {
    "platmap": {
      "title": "Site Platmap",
      "description": "Official platmap with lot boundaries",
      "icon": "üìç"
    },
    "entitlements": {
      "hide": true
    },
    "llc_info": {
      "title": "Company Information",
      "description": "LLC documentation and corporate structure"
    }
  }
}
```

| Field | Type | Description |
|-------|------|-------------|
| `title` | string | Override display title |
| `description` | string | Override description |
| `icon` | string | Custom icon/emoji |
| `hide` | boolean | Hide from display |

### Document Types

Recognized document categories:

- `platmap` - Plat maps and lot maps
- `entitlements` - Permits and approvals
- `grading` - Grading plans
- `llc_info` - Company information
- `presentation` - Marketing presentations
- `title_report` - Title reports
- `plan_assignment` - Plan assignments

## Theme Configuration

### Color Customization

Override default colors in site data:

```json
{
  "theme": {
    "primary": "#0a5071",
    "accent": "#2a7299",
    "success": "#00897b",
    "sand": "#e8d5a7",
    "ocean": "#003d5b"
  }
}
```

### CSS Variables

Available CSS custom properties:

```css
:root {
  --brand-ocean-900: #003d5b;
  --brand-ocean-700: #0a5071;
  --brand-ocean-500: #2a7299;
  --brand-sand-200: #f4e4c1;
  --brand-sand-300: #e8d5a7;
  --brand-sand-400: #d4b896;
  --foam-white: #fefefe;
  --sky-light: #e3f2fd;
}
```

## Environment Configuration

### URL Parameters

Control site behavior via URL:

| Parameter | Example | Description |
|-----------|---------|-------------|
| `site` | `?site=lancaster-12` | Load specific site |
| `debug` | `?debug=1` | Enable debug mode |
| `debugImages` | `?debugImages=1` | Debug image loading |

### Local Storage

Settings stored in browser:

- `lastSite` - Remember last visited site
- `debugEnabled` - Persist debug mode
- `theme` - User theme preference

## File Organization

### Required Structure

```
project/
‚îú‚îÄ‚îÄ config/
‚îÇ   ‚îî‚îÄ‚îÄ images.json         # Image configuration
‚îú‚îÄ‚îÄ sites/
‚îÇ   ‚îî‚îÄ‚îÄ [site-name]/
‚îÇ       ‚îî‚îÄ‚îÄ data.json       # Site data
‚îú‚îÄ‚îÄ sites.config.json       # Master configuration
‚îî‚îÄ‚îÄ public/                 # Static assets
    ‚îú‚îÄ‚îÄ backgrounds/
    ‚îú‚îÄ‚îÄ brand/
    ‚îî‚îÄ‚îÄ lots/
```

### Naming Conventions

1. **Site slugs**: Lowercase with hyphens (`lancaster-12`)
2. **File names**: Hyphens instead of spaces
3. **Config keys**: Snake_case or camelCase
4. **CSS classes**: Kebab-case

## Validation

### Configuration Validation

The system validates:

1. Required fields are present
2. File paths exist
3. Drive IDs are valid format
4. Lot numbers match lot_count
5. Document references are valid

### Debug Tools

Enable debugging to validate configuration:

```javascript
// In browser console
window.Log.setEnabled(true);
window.Log.setLevel('debug');

// Check image configuration
console.log(window.ImagesDebug.config);

// Validate site data
console.log(window.currentSite);
```

## Migration Guide

### From Drive-Only to Local Images

1. Download images from Drive
2. Place in `public/` directories
3. Update `config/images.json`:
   ```json
   {
     "owner": {
       "photo": {
         "src": "/public/brand/owner/photo.jpg"
       }
     }
   }
   ```
4. Remove Drive IDs from configuration

### Adding New Sites

1. Create site configuration in `sites.config.json`
2. Run smart mapper: `python scripts/smart_site_mapper.py`
3. Review generated `sites/[name]/data.json`
4. Test with `make serve`
5. Deploy changes

## Best Practices

1. **Keep configurations DRY** - Use global defaults
2. **Version control** - Commit configuration changes
3. **Document changes** - Update README for new options
4. **Test locally** - Always test before deploying
5. **Use debug mode** - Validate configuration changes
6. **Backup configurations** - Keep copies of working configs

## Troubleshooting

### Common Issues

1. **Site not loading**
   - Check `sites.config.json` for site entry
   - Verify `sites/[name]/data.json` exists
   - Check browser console for errors

2. **Images not showing**
   - Verify paths in `config/images.json`
   - Check file exists in `public/`
   - Enable image debugging: `?debugImages=1`

3. **Documents not matching**
   - Review file names in Drive
   - Check `aliases` in site config
   - Run mapper with `--dry-run` to test

4. **Completeness incorrect**
   - Verify `lot_requirements.required_docs`
   - Check `has_*` flags in lot_details
   - Ensure `doc_refs` are set correctly